{"project": [0, 1, 2], "duplicate_rows": {"duplicated_indices": [], "num_duplicated_rows": 0, "remove_duplicates": false}, "missing_columns": {"missing_column_indices": [], "missing_column_names": [], "remove_columns": []}, "duplicate_columns": {"duplicated_column_indices": [], "duplicated_column_names": [], "remove_columns": []}, "x_y_columns": {"x_y_column_indices": [], "x_y_column_names": [], "remove_columns": []}, "index_columns": {"index_column_indices": [], "index_column_names": [], "remove_columns": []}, "data_type": {"TH_T_ID": {"data_type": "BIGINT"}, "TH_DTS": {"data_type": "VARCHAR"}, "TH_ST_ID": {"data_type": "VARCHAR"}}, "main_entity": {"summary": "Trade Transaction", "reasoning": "The table is about the history of trades in a financial or trading system. The 'TH_T_ID' column suggests that each row is associated with a trade transaction, as it appears to be an identifier for trades. The 'TH_DTS' column records the date and time of a specific status update or action taken on the trade, indicating when the event occurred. The 'TH_ST_ID' column represents the status of the trade at the recorded time, such as submitted, completed, pending, or canceled. The main underlying entity is the trade transaction itself, as all the columns are attributes describing the state and progression of individual trades over time."}, "column_meaning": {"summary": [{"column": "TH_T_ID", "meaning": "Trade ID, unique identifier for each trade"}, {"column": "TH_DTS", "meaning": "Date and time stamp of the trade action"}, {"column": "TH_ST_ID", "meaning": "Trade status ID, indicating the current status of the trade"}]}, "rename_column": {"summary": [{"column": "TH_T_ID", "ambiguous": false, "rename": ""}, {"column": "TH_DTS", "ambiguous": false, "rename": ""}, {"column": "TH_ST_ID", "ambiguous": false, "rename": ""}]}, "table_summary": {"summary": "The table 'src_trade_history' captures a detailed log of trade transactions. It consists of 982,180 rows, each representing an individual trade event, and is structured with 3 key attributes.\n\nThe first attribute, **TH_T_ID**, appears to be a transaction identifier, which is used to uniquely identify each trade event. Notably, the same transaction identifier is seen in the first two rows, suggesting that multiple events can be associated with a single trade.\n\nThe second attribute, **TH_DTS**, represents the date and time stamp of the trade event, indicating the precise moment when each transaction event occurred. This attribute allows for tracking the chronological sequence of trade events.\n\nThe third and final attribute, **TH_ST_ID**, seems to denote the status identifier of the trade, providing insight into the current state of the transaction, such as whether it has been submitted, completed, or is in another state.\n\nTogether, these attributes provide a comprehensive overview of the trade transaction history, capturing the lifecycle of trades from submission to completion or other statuses."}, "column_grouping": {"summary": {"Trade Transaction": {"Trade": {"Identifiers": ["TH_T_ID"], "Attributes": {"Timestamp": ["TH_DTS"], "Status": ["TH_ST_ID"]}}}}}, "visualization": {"summary": [{"name": "Histogram", "params": "TH_ST_ID"}, {"name": "Histogram", "params": "TH_T_ID"}]}, "missing_value": {"TH_T_ID": {}, "TH_DTS": {}, "TH_ST_ID": {}}, "unusual": {"TH_T_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "TH_DTS": {"summary": {"Unusualness": false, "Examples": ""}}, "TH_ST_ID": {"summary": {"Unusualness": false, "Examples": ""}}}, "recommend_testing": [{"name": "Trade Timestamp Order", "reasoning": "For each trade ID, the trade timestamps should be in chronological order, meaning a trade cannot have a subsequent state with a timestamp earlier than a previous state.", "sql": "SELECT a.TH_T_ID, a.TH_DTS as earlier_dts, b.TH_DTS as later_dts FROM src_trade_history a JOIN src_trade_history b ON a.TH_T_ID = b.TH_T_ID WHERE a.TH_DTS > b.TH_DTS AND a.TH_ST_ID != 'CNCL' AND b.TH_ST_ID != 'SBMT'"}, {"name": "Trade State Progression", "reasoning": "A trade should not move from a 'completed' state back to 'submitted' or 'pending'.", "sql": "SELECT a.TH_T_ID, a.TH_ST_ID as prev_state, b.TH_ST_ID as next_state, a.TH_DTS as prev_dts, b.TH_DTS as next_dts FROM src_trade_history a JOIN src_trade_history b ON a.TH_T_ID = b.TH_T_ID WHERE (a.TH_ST_ID = 'CMPT' AND b.TH_ST_ID IN ('SBMT', 'PNDG')) OR (a.TH_ST_ID = 'CNCL' AND b.TH_ST_ID IN ('SBMT', 'PNDG', 'CMPT'))"}, {"name": "Unique Trade Timestamps", "reasoning": "Each trade should have a unique timestamp for each state to avoid ambiguity in the trade history.", "sql": "SELECT TH_T_ID, TH_DTS, COUNT(*) as cnt FROM src_trade_history GROUP BY TH_T_ID, TH_DTS HAVING cnt > 1"}, {"name": "Valid Trade State Transitions", "reasoning": "Trades should follow a valid state transition: from 'submitted' to 'pending' to 'completed', or can be 'cancelled' from any state.", "sql": "SELECT a.TH_T_ID, a.TH_ST_ID as prev_state, b.TH_ST_ID as next_state, a.TH_DTS as prev_dts, b.TH_DTS as next_dts FROM src_trade_history a JOIN src_trade_history b ON a.TH_T_ID = b.TH_T_ID WHERE (a.TH_ST_ID = 'SBMT' AND b.TH_ST_ID = 'CMPT') OR (a.TH_ST_ID = 'PNDG' AND b.TH_ST_ID = 'SBMT')"}]}