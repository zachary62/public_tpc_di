{"project": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "duplicate_rows": {"duplicated_indices": [], "num_duplicated_rows": 0, "remove_duplicates": false}, "missing_columns": {"missing_column_indices": [], "missing_column_names": [], "remove_columns": []}, "duplicate_columns": {"duplicated_column_indices": [], "duplicated_column_names": [], "remove_columns": []}, "x_y_columns": {"x_y_column_indices": [], "x_y_column_names": [], "remove_columns": []}, "index_columns": {"index_column_indices": [], "index_column_names": [], "remove_columns": []}, "data_type": {"SK_DATE_ID": {"data_type": "BIGINT"}, "DATE_VALUE": {"data_type": "TIMESTAMP"}, "DATE_DESC": {"data_type": "VARCHAR"}, "CALENDAR_YEAR_ID": {"data_type": "BIGINT"}, "CALENDAR_QTR_ID": {"data_type": "BIGINT"}, "CALENDAR_QTR_DESC": {"data_type": "VARCHAR"}, "CALENDAR_MONTH_ID": {"data_type": "BIGINT"}, "CALENDAR_MONTH_DESC": {"data_type": "VARCHAR"}, "CALENDAR_WEEK_ID": {"data_type": "BIGINT"}, "CALENDAR_WEEK_DESC": {"data_type": "VARCHAR"}, "DAY_OF_WEEK_NUM": {"data_type": "BIGINT"}, "DAY_OF_WEEK_DESC": {"data_type": "VARCHAR"}, "FISCAL_YEAR_ID": {"data_type": "BIGINT"}, "FISCAL_QTR_ID": {"data_type": "BIGINT"}, "FISCAL_QTR_DESC": {"data_type": "VARCHAR"}, "HOLIDAY_FLAG": {"data_type": "BOOLEAN"}}, "main_entity": {"summary": "Date", "reasoning": "The table is about recording various attributes and descriptors related to dates. It includes information about specific dates, their descriptions, their position in the calendar year, quarter, month, and week, the day of the week, fiscal year and quarter information, and whether the date is a holiday. The primary focus of the table is to provide a structured way to reference and analyze dates in relation to both the standard calendar and the fiscal calendar. The main underlying entity that all these attributes describe is a specific 'Date'."}, "column_meaning": {"summary": [{"column": "SK_DATE_ID", "meaning": "unique identifier for each date"}, {"column": "DATE_VALUE", "meaning": "actual date in year-month-day format"}, {"column": "DATE_DESC", "meaning": "description of the date in words"}, {"column": "CALENDAR_YEAR_ID", "meaning": "year of the date"}, {"column": "CALENDAR_QTR_ID", "meaning": "identifier for the quarter of the year"}, {"column": "CALENDAR_QTR_DESC", "meaning": "description of the quarter of the year"}, {"column": "CALENDAR_MONTH_ID", "meaning": "identifier for the month of the year"}, {"column": "CALENDAR_MONTH_DESC", "meaning": "description of the month of the year"}, {"column": "CALENDAR_WEEK_ID", "meaning": "identifier for the week of the year"}, {"column": "CALENDAR_WEEK_DESC", "meaning": "description of the week of the year"}, {"column": "DAY_OF_WEEK_NUM", "meaning": "numeric representation of the day of the week"}, {"column": "DAY_OF_WEEK_DESC", "meaning": "description of the day of the week"}, {"column": "FISCAL_YEAR_ID", "meaning": "fiscal year of the date"}, {"column": "FISCAL_QTR_ID", "meaning": "identifier for the fiscal quarter"}, {"column": "FISCAL_QTR_DESC", "meaning": "description of the fiscal quarter"}, {"column": "HOLIDAY_FLAG", "meaning": "indicator if the date is a holiday"}]}, "rename_column": {"summary": [{"column": "SK_DATE_ID", "ambiguous": false, "rename": ""}, {"column": "DATE_VALUE", "ambiguous": false, "rename": ""}, {"column": "DATE_DESC", "ambiguous": true, "rename": "DATE_DESCRIPTION"}, {"column": "CALENDAR_YEAR_ID", "ambiguous": false, "rename": ""}, {"column": "CALENDAR_QTR_ID", "ambiguous": false, "rename": ""}, {"column": "CALENDAR_QTR_DESC", "ambiguous": true, "rename": "CALENDAR_QUARTER_DESCRIPTION"}, {"column": "CALENDAR_MONTH_ID", "ambiguous": false, "rename": ""}, {"column": "CALENDAR_MONTH_DESC", "ambiguous": true, "rename": "CALENDAR_MONTH_DESCRIPTION"}, {"column": "CALENDAR_WEEK_ID", "ambiguous": false, "rename": ""}, {"column": "CALENDAR_WEEK_DESC", "ambiguous": true, "rename": "CALENDAR_WEEK_DESCRIPTION"}, {"column": "DAY_OF_WEEK_NUM", "ambiguous": false, "rename": ""}, {"column": "DAY_OF_WEEK_DESC", "ambiguous": true, "rename": "DAY_OF_WEEK_DESCRIPTION"}, {"column": "FISCAL_YEAR_ID", "ambiguous": false, "rename": ""}, {"column": "FISCAL_QTR_ID", "ambiguous": false, "rename": ""}, {"column": "FISCAL_QTR_DESC", "ambiguous": true, "rename": "FISCAL_QUARTER_DESCRIPTION"}, {"column": "HOLIDAY_FLAG", "ambiguous": false, "rename": ""}]}, "table_summary": {"summary": "The table 'dim_date' is a comprehensive date dimension that provides detailed temporal information for each date entry. It serves as a reference for analyzing data over time, with a focus on both calendar and fiscal date attributes.\n\nAt the core of the table is the **SK_DATE_ID**, a surrogate key that uniquely identifies each date record. The **DATE_VALUE** attribute represents the actual date in a standard 'YYYY-MM-DD' format, while the **DATE_DESC** provides a textual description of the date.\n\nThe table includes attributes that break down the date into calendar and fiscal components. The **CALENDAR_YEAR_ID** and **FISCAL_YEAR_ID** denote the calendar and fiscal years, respectively. Each year is further divided into quarters, as indicated by **CALENDAR_QTR_ID** and **FISCAL_QTR_ID**, with corresponding descriptions in **CALENDAR_QTR_DESC** and **FISCAL_QTR_DESC**.\n\nMonths and weeks within the calendar year are identified by **CALENDAR_MONTH_ID** and **CALENDAR_WEEK_ID**, with their descriptions in **CALENDAR_MONTH_DESC** and **CALENDAR_WEEK_DESC**. The **DAY_OF_WEEK_NUM** provides a numerical representation of the day within the week, while **DAY_OF_WEEK_DESC** offers a textual name for the day.\n\nLastly, the **HOLIDAY_FLAG** attribute indicates whether the date is considered a holiday, providing a boolean value that can be used for filtering or special analyses. \n\nOverall, the 'dim_date' table is structured to offer a multi-faceted view of dates, accommodating various temporal analyses and reporting needs by incorporating all these Attributes."}, "column_grouping": {"summary": {"Date": {"Identifiers": {"Primary": ["SK_DATE_ID"], "Temporal": ["DATE_VALUE", "CALENDAR_QTR_ID", "CALENDAR_MONTH_ID", "CALENDAR_WEEK_ID", "DAY_OF_WEEK_NUM"]}, "Descriptions": {"General": ["DATE_DESC"], "Calendar": {"Year": ["CALENDAR_YEAR_ID"], "Quarter": ["CALENDAR_QTR_DESC"], "Month": ["CALENDAR_MONTH_DESC"], "Week": ["CALENDAR_WEEK_DESC"], "Day": ["DAY_OF_WEEK_DESC"]}, "Fiscal": {"Year": ["FISCAL_YEAR_ID"], "Quarter": ["FISCAL_QTR_ID", "FISCAL_QTR_DESC"]}}, "Flags": {"Holiday": ["HOLIDAY_FLAG"]}}}}, "visualization": {"summary": [{"name": "Histogram", "params": "CALENDAR_YEAR_ID"}, {"name": "Histogram", "params": "FISCAL_YEAR_ID"}, {"name": "Histogram", "params": "CALENDAR_QTR_ID"}, {"name": "Histogram", "params": "FISCAL_QTR_ID"}, {"name": "Histogram", "params": "CALENDAR_MONTH_ID"}, {"name": "Histogram", "params": "DAY_OF_WEEK_NUM"}, {"name": "Histogram", "params": "HOLIDAY_FLAG"}]}, "missing_value": {"SK_DATE_ID": {}, "DATE_VALUE": {}, "DATE_DESC": {}, "CALENDAR_YEAR_ID": {}, "CALENDAR_QTR_ID": {}, "CALENDAR_QTR_DESC": {}, "CALENDAR_MONTH_ID": {}, "CALENDAR_MONTH_DESC": {}, "CALENDAR_WEEK_ID": {}, "CALENDAR_WEEK_DESC": {}, "DAY_OF_WEEK_NUM": {}, "DAY_OF_WEEK_DESC": {}, "FISCAL_YEAR_ID": {}, "FISCAL_QTR_ID": {}, "FISCAL_QTR_DESC": {}, "HOLIDAY_FLAG": {}}, "unusual": {"SK_DATE_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "DATE_VALUE": {"summary": {"Unusualness": false, "Examples": ""}}, "DATE_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "CALENDAR_YEAR_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "CALENDAR_QTR_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "CALENDAR_QTR_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "CALENDAR_MONTH_ID": {"summary": {"Unusualness": true, "Examples": "Values like '195013', '195014', etc., are unusual because there are only 12 months in a year.", "Explanation": "Unclear"}}, "CALENDAR_MONTH_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "CALENDAR_WEEK_ID": {"summary": {"Unusualness": true, "Examples": "Values like '195222' are unusual because a year cannot have 222 weeks. Additionally, the lack of leading zeros for weeks 1-9 and the direct concatenation of week numbers to years without a separator are not standard representations of calendar week identifiers.", "Explanation": "Unclear"}}, "CALENDAR_WEEK_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "DAY_OF_WEEK_NUM": {"summary": {"Unusualness": false, "Examples": ""}}, "DAY_OF_WEEK_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "FISCAL_YEAR_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "FISCAL_QTR_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "FISCAL_QTR_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "HOLIDAY_FLAG": {"summary": {"Unusualness": false, "Examples": ""}}}, "recommend_testing": [{"name": "Calendar Quarter Consistency Check", "reasoning": "The calendar quarter ID should correspond to the year and quarter described in the calendar quarter description", "sql": "select * from dim_date where CONCAT(CALENDAR_YEAR_ID, ' Q', (CALENDAR_QTR_ID % 10)) != CALENDAR_QTR_DESC"}, {"name": "Calendar Month Consistency Check", "reasoning": "The calendar month ID should correspond to the year and month described in the calendar month description", "sql": "select * from dim_date where CONCAT(CALENDAR_YEAR_ID, ' ', SUBSTRING('January  February March    April    May      June     July     August   SeptemberOctober  November December ', ((CALENDAR_MONTH_ID % 100) - 1) * 9 + 1, 9)) != CALENDAR_MONTH_DESC"}, {"name": "Calendar Week Year Consistency Check", "reasoning": "The calendar week ID should start with the year", "sql": "select * from dim_date where CAST(SUBSTRING(CALENDAR_WEEK_DESC, 1, 4) AS BIGINT) != (CALENDAR_WEEK_ID / 100)"}, {"name": "Day of Week Description Check", "reasoning": "The day of the week number should correspond to the correct day of the week description", "sql": "select * from dim_date where DAY_OF_WEEK_DESC not in ('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday') or (DAY_OF_WEEK_NUM = 1 and DAY_OF_WEEK_DESC != 'Monday') or (DAY_OF_WEEK_NUM = 2 and DAY_OF_WEEK_DESC != 'Tuesday') or (DAY_OF_WEEK_NUM = 3 and DAY_OF_WEEK_DESC != 'Wednesday') or (DAY_OF_WEEK_NUM = 4 and DAY_OF_WEEK_DESC != 'Thursday') or (DAY_OF_WEEK_NUM = 5 and DAY_OF_WEEK_DESC != 'Friday') or (DAY_OF_WEEK_NUM = 6 and DAY_OF_WEEK_DESC != 'Saturday') or (DAY_OF_WEEK_NUM = 7 and DAY_OF_WEEK_DESC != 'Sunday')"}, {"name": "Fiscal Quarter Consistency Check", "reasoning": "The fiscal quarter ID should correspond to the year and quarter described in the fiscal quarter description", "sql": "select * from dim_date where CONCAT(FISCAL_YEAR_ID, ' Q', (FISCAL_QTR_ID % 10)) != FISCAL_QTR_DESC"}, {"name": "Date Value and Description Match Check", "reasoning": "The DATE_VALUE should match the DATE_DESC in terms of year, month, and day", "sql": "select * from dim_date where TO_DATE(DATE_DESC, 'YYYY-MM-DD') != DATE_VALUE"}, {"name": "Holiday Flag Consistency Check", "reasoning": "If the HOLIDAY_FLAG is true, the day should not be a regular workday (Monday to Friday)", "sql": "select * from dim_date where HOLIDAY_FLAG = True and DAY_OF_WEEK_NUM between 1 and 5"}]}