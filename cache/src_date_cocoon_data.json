{"project": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "duplicate_rows": {"duplicated_indices": [], "num_duplicated_rows": 0, "remove_duplicates": false}, "missing_columns": {"missing_column_indices": [], "missing_column_names": [], "remove_columns": []}, "duplicate_columns": {"duplicated_column_indices": [], "duplicated_column_names": [], "remove_columns": []}, "x_y_columns": {"x_y_column_indices": [], "x_y_column_names": [], "remove_columns": []}, "index_columns": {"index_column_indices": [], "index_column_names": [], "remove_columns": []}, "data_type": {"SK_DATE_ID": {"data_type": "BIGINT"}, "DATE_VALUE": {"data_type": "VARCHAR"}, "DATE_DESC": {"data_type": "VARCHAR"}, "CALENDAR_YEAR_ID": {"data_type": "BIGINT"}, "CALENDAR_YEAR_DESC": {"data_type": "BIGINT"}, "CALENDAR_QTR_ID": {"data_type": "BIGINT"}, "CALENDAR_QTR_DESC": {"data_type": "VARCHAR"}, "CALENDAR_MONTH_ID": {"data_type": "BIGINT"}, "CALENDAR_MONTH_DESC": {"data_type": "VARCHAR"}, "CALENDAR_WEEK_ID": {"data_type": "BIGINT"}, "CALENDAR_WEEK_DESC": {"data_type": "VARCHAR"}, "DAY_OF_WEEK_NUM": {"data_type": "BIGINT"}, "DAY_OF_WEEK_DESC": {"data_type": "VARCHAR"}, "FISCAL_YEAR_ID": {"data_type": "BIGINT"}, "FISCAL_YEAR_DESC": {"data_type": "BIGINT"}, "FISCAL_QTR_ID": {"data_type": "BIGINT"}, "FISCAL_QTR_DESC": {"data_type": "VARCHAR"}, "HOLIDAY_FLAG": {"data_type": "BOOLEAN"}}, "main_entity": {"summary": "Date", "reasoning": "The table is about recording specific dates and their associated descriptions, including various calendar and fiscal year information, quarters, months, weeks, and whether the date is a holiday or not. The data seems to be structured around the concept of a date in a calendar, with additional attributes that provide context to that date in terms of its position in a year, quarter, month, week, and its designation as a holiday. The main underlying entity is the individual date itself, as all other columns provide attributes and descriptions related to that specific date."}, "column_meaning": {"summary": [{"column": "SK_DATE_ID", "meaning": "unique identifier for each date"}, {"column": "DATE_VALUE", "meaning": "actual date in YYYY-MM-DD format"}, {"column": "DATE_DESC", "meaning": "description of the date"}, {"column": "CALENDAR_YEAR_ID", "meaning": "year of the date"}, {"column": "CALENDAR_YEAR_DESC", "meaning": "description of the year"}, {"column": "CALENDAR_QTR_ID", "meaning": "identifier for the quarter of the year"}, {"column": "CALENDAR_QTR_DESC", "meaning": "description of the quarter"}, {"column": "CALENDAR_MONTH_ID", "meaning": "identifier for the month of the year"}, {"column": "CALENDAR_MONTH_DESC", "meaning": "description of the month"}, {"column": "CALENDAR_WEEK_ID", "meaning": "identifier for the week of the year"}, {"column": "CALENDAR_WEEK_DESC", "meaning": "description of the week"}, {"column": "DAY_OF_WEEK_NUM", "meaning": "numeric representation of the day of the week"}, {"column": "DAY_OF_WEEK_DESC", "meaning": "description of the day of the week"}, {"column": "FISCAL_YEAR_ID", "meaning": "fiscal year identifier"}, {"column": "FISCAL_YEAR_DESC", "meaning": "description of the fiscal year"}, {"column": "FISCAL_QTR_ID", "meaning": "identifier for the fiscal quarter"}, {"column": "FISCAL_QTR_DESC", "meaning": "description of the fiscal quarter"}, {"column": "HOLIDAY_FLAG", "meaning": "indicates if the date is a holiday"}]}, "rename_column": {"summary": [{"column": "SK_DATE_ID", "ambiguous": false, "rename": ""}, {"column": "DATE_VALUE", "ambiguous": false, "rename": ""}, {"column": "DATE_DESC", "ambiguous": true, "rename": "DATE_DESCRIPTION"}, {"column": "CALENDAR_YEAR_ID", "ambiguous": false, "rename": ""}, {"column": "CALENDAR_YEAR_DESC", "ambiguous": true, "rename": "CALENDAR_YEAR_DESCRIPTION"}, {"column": "CALENDAR_QTR_ID", "ambiguous": false, "rename": ""}, {"column": "CALENDAR_QTR_DESC", "ambiguous": true, "rename": "CALENDAR_QUARTER_DESCRIPTION"}, {"column": "CALENDAR_MONTH_ID", "ambiguous": false, "rename": ""}, {"column": "CALENDAR_MONTH_DESC", "ambiguous": true, "rename": "CALENDAR_MONTH_DESCRIPTION"}, {"column": "CALENDAR_WEEK_ID", "ambiguous": false, "rename": ""}, {"column": "CALENDAR_WEEK_DESC", "ambiguous": true, "rename": "CALENDAR_WEEK_DESCRIPTION"}, {"column": "DAY_OF_WEEK_NUM", "ambiguous": false, "rename": ""}, {"column": "DAY_OF_WEEK_DESC", "ambiguous": true, "rename": "DAY_OF_WEEK_DESCRIPTION"}, {"column": "FISCAL_YEAR_ID", "ambiguous": false, "rename": ""}, {"column": "FISCAL_YEAR_DESC", "ambiguous": true, "rename": "FISCAL_YEAR_DESCRIPTION"}, {"column": "FISCAL_QTR_ID", "ambiguous": false, "rename": ""}, {"column": "FISCAL_QTR_DESC", "ambiguous": true, "rename": "FISCAL_QUARTER_DESCRIPTION"}, {"column": "HOLIDAY_FLAG", "ambiguous": false, "rename": ""}]}, "table_summary": {"summary": "The table 'src_date' is a comprehensive dataset that captures various aspects of dates ranging from the year 1950 onwards. It serves as a dimensional table in a data warehouse or a database designed to facilitate time-based analysis and reporting.\n\nAt its core, the table provides a unique identifier for each date entry with the **SK_DATE_ID** attribute, which likely stands for \"Surrogate Key Date ID.\" The actual date is recorded in the **DATE_VALUE** attribute in a standard YYYY-MM-DD format. Each date is described textually in the **DATE_DESC** attribute, providing a human-readable form such as \"January 1, 1950.\"\n\nThe table includes attributes that categorize each date into different time dimensions. The **CALENDAR_YEAR_ID** and **CALENDAR_YEAR_DESC** attributes denote the calendar year number and description, respectively. Similarly, the **CALENDAR_QTR_ID** and **CALENDAR_QTR_DESC** attributes break down the year into quarters, indicating both the quarter number and its description (e.g., \"1950 Q1\").\n\nFurther granularity is provided by the **CALENDAR_MONTH_ID** and **CALENDAR_MONTH_DESC** attributes, which specify the month within the year. The **CALENDAR_WEEK_ID** and **CALENDAR_WEEK_DESC** attributes do the same for weeks, following a likely pattern of \"YYYY-WX\" where X represents the week number within the year.\n\nThe day of the week is captured by the **DAY_OF_WEEK_NUM** and **DAY_OF_WEEK_DESC** attributes, with the former being a numerical representation (e.g., 7 for Sunday) and the latter being a textual description (e.g., \"Sunday\").\n\nThe table also aligns dates with a fiscal calendar, which may differ from the standard calendar. This is represented by the **FISCAL_YEAR_ID** and **FISCAL_YEAR_DESC** attributes for the fiscal year, and the **FISCAL_QTR_ID** and **FISCAL_QTR_DESC** for the fiscal quarter.\n\nLastly, the table indicates whether a date is associated with a holiday through the **HOLIDAY_FLAG** attribute, which is a Boolean value signifying the presence of a holiday on that particular date.\n\nIn summary, the 'src_date' table is a detailed schema that provides a multi-dimensional view of dates, accommodating both standard and fiscal calendar systems, and identifying holidays, making it a valuable resource for temporal data analysis and reporting."}, "column_grouping": {"summary": {"Date": {"Identifiers": {"Primary": ["SK_DATE_ID"], "Temporal": ["CALENDAR_YEAR_ID", "CALENDAR_QTR_ID", "CALENDAR_MONTH_ID", "CALENDAR_WEEK_ID", "DAY_OF_WEEK_NUM", "FISCAL_YEAR_ID", "FISCAL_QTR_ID"]}, "Descriptions": {"Date": ["DATE_DESC"], "Calendar": {"Year": ["CALENDAR_YEAR_DESC"], "Quarter": ["CALENDAR_QTR_DESC"], "Month": ["CALENDAR_MONTH_DESC"], "Week": ["CALENDAR_WEEK_DESC"], "Day": ["DAY_OF_WEEK_DESC"]}, "Fiscal": {"Year": ["FISCAL_YEAR_DESC"], "Quarter": ["FISCAL_QTR_DESC"]}}, "Flags": {"Holiday": ["HOLIDAY_FLAG"]}, "Values": {"Date": ["DATE_VALUE"]}}}}, "visualization": {"summary": [{"name": "Histogram", "params": "CALENDAR_YEAR_ID"}, {"name": "Histogram", "params": "CALENDAR_MONTH_DESC"}, {"name": "Histogram", "params": "DAY_OF_WEEK_DESC"}, {"name": "Histogram", "params": "FISCAL_QTR_ID"}, {"name": "Histogram", "params": "HOLIDAY_FLAG"}]}, "missing_value": {"SK_DATE_ID": {}, "DATE_VALUE": {}, "DATE_DESC": {}, "CALENDAR_YEAR_ID": {}, "CALENDAR_YEAR_DESC": {}, "CALENDAR_QTR_ID": {}, "CALENDAR_QTR_DESC": {}, "CALENDAR_MONTH_ID": {}, "CALENDAR_MONTH_DESC": {}, "CALENDAR_WEEK_ID": {}, "CALENDAR_WEEK_DESC": {}, "DAY_OF_WEEK_NUM": {}, "DAY_OF_WEEK_DESC": {}, "FISCAL_YEAR_ID": {}, "FISCAL_YEAR_DESC": {}, "FISCAL_QTR_ID": {}, "FISCAL_QTR_DESC": {}, "HOLIDAY_FLAG": {}}, "unusual": {"SK_DATE_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "DATE_VALUE": {"summary": {"Unusualness": false, "Examples": ""}}, "DATE_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "CALENDAR_YEAR_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "CALENDAR_YEAR_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "CALENDAR_QTR_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "CALENDAR_QTR_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "CALENDAR_MONTH_ID": {"summary": {"Unusualness": true, "Examples": "Values like '195013' to '195012' are unusual because there are no more than 12 months in a year. The jump from '195012' to '19511' is also unusual as it skips the expected '195101' for January 1951.", "Explanation": "Unclear"}}, "CALENDAR_MONTH_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "CALENDAR_WEEK_ID": {"summary": {"Unusualness": true, "Examples": "Values like '195010' are unusual because they could be misinterpreted as year 1950, week 10, instead of the correct year and week. Additionally, the presence of '1950' as a year is questionable if the data is expected to be recent.", "Explanation": "Unclear"}}, "CALENDAR_WEEK_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "DAY_OF_WEEK_NUM": {"summary": {"Unusualness": false, "Examples": ""}}, "DAY_OF_WEEK_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "FISCAL_YEAR_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "FISCAL_YEAR_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "FISCAL_QTR_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "FISCAL_QTR_DESC": {"summary": {"Unusualness": false, "Examples": ""}}, "HOLIDAY_FLAG": {"summary": {"Unusualness": false, "Examples": ""}}}, "recommend_testing": [{"name": "Calendar Year and Quarter Consistency", "reasoning": "The year part of the CALENDAR_QTR_ID should match the CALENDAR_YEAR_ID", "sql": "select * from src_date where cast(substr(cast(CALENDAR_QTR_ID as varchar), 1, 4) as bigint) != CALENDAR_YEAR_ID"}, {"name": "Calendar Year and Month Consistency", "reasoning": "The year part of the CALENDAR_MONTH_ID should match the CALENDAR_YEAR_ID", "sql": "select * from src_date where cast(substr(cast(CALENDAR_MONTH_ID as varchar), 1, 4) as bigint) != CALENDAR_YEAR_ID"}, {"name": "Calendar Year and Week Consistency", "reasoning": "The year part of the CALENDAR_WEEK_ID should match the CALENDAR_YEAR_ID", "sql": "select * from src_date where cast(substr(cast(CALENDAR_WEEK_ID as varchar), 1, 4) as bigint) != CALENDAR_YEAR_ID"}, {"name": "Fiscal Year and Quarter Consistency", "reasoning": "The year part of the FISCAL_QTR_ID should match the FISCAL_YEAR_ID", "sql": "select * from src_date where cast(substr(cast(FISCAL_QTR_ID as varchar), 1, 4) as bigint) != FISCAL_YEAR_ID"}, {"name": "Date Description Format", "reasoning": "The DATE_DESC should match the format 'Month Day, Year' of the DATE_VALUE", "sql": "select * from src_date where DATE_DESC != to_char(DATE_VALUE, 'Month DD, YYYY')"}, {"name": "Day of Week Consistency", "reasoning": "The DAY_OF_WEEK_NUM should correspond to the DAY_OF_WEEK_DESC", "sql": "select * from src_date where (DAY_OF_WEEK_DESC = 'Sunday' and DAY_OF_WEEK_NUM != 7) or (DAY_OF_WEEK_DESC = 'Monday' and DAY_OF_WEEK_NUM != 1) or (DAY_OF_WEEK_DESC = 'Tuesday' and DAY_OF_WEEK_NUM != 2) or (DAY_OF_WEEK_DESC = 'Wednesday' and DAY_OF_WEEK_NUM != 3) or (DAY_OF_WEEK_DESC = 'Thursday' and DAY_OF_WEEK_NUM != 4) or (DAY_OF_WEEK_DESC = 'Friday' and DAY_OF_WEEK_NUM != 5) or (DAY_OF_WEEK_DESC = 'Saturday' and DAY_OF_WEEK_NUM != 6)"}, {"name": "Holiday Flag Consistency", "reasoning": "If HOLIDAY_FLAG is true, the DAY_OF_WEEK_DESC should typically be 'Saturday' or 'Sunday', or the DATE_VALUE should correspond to a known holiday date", "sql": "select * from src_date where HOLIDAY_FLAG = True and DAY_OF_WEEK_DESC not in ('Saturday', 'Sunday') and DATE_VALUE not in (SELECT holiday_date FROM known_holidays)"}]}