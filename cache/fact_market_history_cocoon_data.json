{"project": [0, 1, 2, 3, 4, 5], "duplicate_rows": {"duplicated_indices": [], "num_duplicated_rows": 0, "remove_duplicates": false}, "missing_columns": {"missing_column_indices": [], "missing_column_names": [], "remove_columns": []}, "duplicate_columns": {"duplicated_column_indices": [], "duplicated_column_names": [], "remove_columns": []}, "x_y_columns": {"x_y_column_indices": [], "x_y_column_names": [], "remove_columns": []}, "index_columns": {"index_column_indices": [], "index_column_names": [], "remove_columns": []}, "data_type": {"DM_DATE": {"data_type": "TIMESTAMP"}, "DM_S_SYMB": {"data_type": "VARCHAR"}, "DM_CLOSE": {"data_type": "DOUBLE"}, "DM_HIGH": {"data_type": "DOUBLE"}, "DM_LOW": {"data_type": "DOUBLE"}, "DM_VOL": {"data_type": "BIGINT"}}, "main_entity": {"summary": "Market History Record", "reasoning": "The table is about the historical trading data for various securities on specific dates. It records the closing price, highest price, lowest price, and trading volume for each security symbol on a given date. The main entities suggested by the data are 'Security' and 'Date'. However, since each row seems to represent a daily market summary for a specific security, the main relationship entity that groups 'Security' and 'Date' together is a 'Market History Record' or 'Daily Trading Record'."}, "column_meaning": {"summary": [{"column": "DM_DATE", "meaning": "date of the market data"}, {"column": "DM_S_SYMB", "meaning": "stock symbol"}, {"column": "DM_CLOSE", "meaning": "closing price"}, {"column": "DM_HIGH", "meaning": "highest price of the day"}, {"column": "DM_LOW", "meaning": "lowest price of the day"}, {"column": "DM_VOL", "meaning": "trading volume"}]}, "rename_column": {"summary": [{"column": "DM_DATE", "ambiguous": false, "rename": ""}, {"column": "DM_S_SYMB", "ambiguous": false, "rename": ""}, {"column": "DM_CLOSE", "ambiguous": false, "rename": ""}, {"column": "DM_HIGH", "ambiguous": false, "rename": ""}, {"column": "DM_LOW", "ambiguous": false, "rename": ""}, {"column": "DM_VOL", "ambiguous": false, "rename": ""}]}, "table_summary": {"summary": "The table 'fact_market_history' captures the daily trading details of various securities on a given **DM_DATE**. It records the closing price (**DM_CLOSE**), the highest price (**DM_HIGH**), the lowest price (**DM_LOW**), and the trading volume (**DM_VOL**) for each security identified by its symbol (**DM_S_SYMB**). With 1,282,768 rows, the table provides a comprehensive historical snapshot of market activity for each security on specific dates, allowing for analysis of price movements and trading patterns over time."}, "column_grouping": {"summary": {"Market History Record": {"Date": ["DM_DATE"], "Stock": {"Identifier": ["DM_S_SYMB"], "Market Data": {"Price": ["DM_CLOSE", "DM_HIGH", "DM_LOW"], "Volume": ["DM_VOL"]}}}}}, "visualization": {"summary": [{"name": "Histogram", "params": "DM_CLOSE"}, {"name": "Histogram", "params": "DM_HIGH"}, {"name": "Histogram", "params": "DM_LOW"}, {"name": "Histogram", "params": "DM_VOL"}]}, "missing_value": {"DM_DATE": {}, "DM_S_SYMB": {}, "DM_CLOSE": {}, "DM_HIGH": {}, "DM_LOW": {}, "DM_VOL": {}}, "unusual": {"DM_DATE": {"summary": {"Unusualness": false, "Examples": ""}}, "DM_S_SYMB": {"summary": {"Unusualness": true, "Examples": "The values are unusual because they are excessively long and not in line with typical stock symbol formats.", "Explanation": "Unclear"}}, "DM_CLOSE": {"summary": {"Unusualness": false, "Examples": ""}}, "DM_HIGH": {"summary": {"Unusualness": false, "Examples": ""}}, "DM_LOW": {"summary": {"Unusualness": false, "Examples": ""}}, "DM_VOL": {"summary": {"Unusualness": false, "Examples": ""}}}, "recommend_testing": [{"name": "High-Low Relationship Check", "reasoning": "The 'DM_HIGH' value for a stock on any given day should always be greater than or equal to the 'DM_LOW' value for the same stock on the same day.", "sql": "SELECT * FROM fact_market_history WHERE DM_HIGH < DM_LOW"}, {"name": "Close within High-Low Range Check", "reasoning": "The 'DM_CLOSE' value should be within the range of 'DM_HIGH' and 'DM_LOW' for the same stock on the same day.", "sql": "SELECT * FROM fact_market_history WHERE DM_CLOSE < DM_LOW OR DM_CLOSE > DM_HIGH"}, {"name": "Date Consistency Check", "reasoning": "The 'DM_DATE' should not have time components as it seems to represent daily data. All timestamps should be at midnight if the time component is present.", "sql": "SELECT * FROM fact_market_history WHERE EXTRACT(HOUR FROM DM_DATE) != 0 OR EXTRACT(MINUTE FROM DM_DATE) != 0 OR EXTRACT(SECOND FROM DM_DATE) != 0"}, {"name": "Symbol Length Check", "reasoning": "If the stock symbols ('DM_S_SYMB') are expected to have a fixed length, this check ensures that all symbols conform to the expected length.", "sql": "SELECT * FROM fact_market_history WHERE LENGTH(DM_S_SYMB) != (SELECT LENGTH('AAAAAAAAAAAABOY') FROM fact_market_history LIMIT 1)"}, {"name": "Volume Non-Negativity Check", "reasoning": "The 'DM_VOL' represents the volume of stocks traded and should not be negative.", "sql": "SELECT * FROM fact_market_history WHERE DM_VOL < 0"}]}