{"project": [0, 1, 2, 3], "duplicate_rows": {"duplicated_indices": [], "num_duplicated_rows": 0, "remove_duplicates": false}, "missing_columns": {"missing_column_indices": [], "missing_column_names": [], "remove_columns": []}, "duplicate_columns": {"duplicated_column_indices": [], "duplicated_column_names": [], "remove_columns": []}, "x_y_columns": {"x_y_column_indices": [], "x_y_column_names": [], "remove_columns": []}, "index_columns": {"index_column_indices": [], "index_column_names": [], "remove_columns": []}, "data_type": {"W_C_ID": {"data_type": "BIGINT"}, "W_S_SYMB": {"data_type": "VARCHAR"}, "W_DTS": {"data_type": "TIMESTAMP"}, "W_ACTION": {"data_type": "VARCHAR"}}, "main_entity": {"summary": "Watch History", "reasoning": "The table is about tracking the history of actions taken on certain items, likely within a system that monitors or records user activity. The 'W_C_ID' column suggests that there is a customer or user ID involved, indicating that the actions are associated with users. The 'W_S_SYMB' column seems to represent some sort of item or symbol that is being acted upon, which could be a product, a stock symbol, or another type of item. The 'W_DTS' column is a timestamp for when the action took place, and the 'W_ACTION' column indicates the type of action that was taken, such as 'ACTV' for active or 'CNCL' for cancel. The main relationship entity here is the history of actions ('W_ACTION') taken by users ('W_C_ID') on items ('W_S_SYMB') at specific times ('W_DTS')."}, "column_meaning": {"summary": [{"column": "W_C_ID", "meaning": "customer identifier"}, {"column": "W_S_SYMB", "meaning": "security symbol being watched"}, {"column": "W_DTS", "meaning": "date and time of the watch action"}, {"column": "W_ACTION", "meaning": "type of action, active or cancelled"}]}, "rename_column": {"summary": [{"column": "W_C_ID", "ambiguous": false, "rename": ""}, {"column": "W_S_SYMB", "ambiguous": false, "rename": ""}, {"column": "W_DTS", "ambiguous": false, "rename": ""}, {"column": "W_ACTION", "ambiguous": true, "rename": "W_STATUS"}]}, "table_summary": {"summary": "The table 'fact_watch_history' captures user interactions with a watch system, detailing when and what actions were taken. The table consists of 900042 rows, each representing a unique event, and is structured with 4 columns that describe these events.\n\nThe first attribute, **W_C_ID**, likely stands for Watch Customer ID, which uniquely identifies the customer associated with the watch event. The second attribute, **W_S_SYMB**, appears to be a Watch Symbol, possibly representing a specific watch or content item that the user interacted with. The third attribute, **W_DTS**, stands for the DateTime Stamp, indicating the precise moment the action was recorded. Lastly, the **W_ACTION** attribute describes the type of action that was taken by the user, such as 'ACTV' which might stand for 'active' or 'activate'.\n\nTogether, these attributes provide a comprehensive log of user activity within the watch system, allowing for analysis of customer behavior over time."}, "column_grouping": {"summary": {"Watch History": {"Customer": {"Customer Details": ["W_C_ID"]}, "Security": {"Security Details": ["W_S_SYMB"]}, "Watch Event": {"Event Details": ["W_DTS", "W_ACTION"]}}}}, "visualization": {"summary": [{"name": "Histogram", "params": "W_ACTION"}, {"name": "Histogram", "params": "W_DTS"}]}, "missing_value": {"W_C_ID": {}, "W_S_SYMB": {}, "W_DTS": {}, "W_ACTION": {}}, "unusual": {"W_C_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "W_S_SYMB": {"summary": {"Unusualness": true, "Examples": "The values are unusual because they are excessively long and do not follow the typical format of security symbols found in financial markets.", "Explanation": "Unclear"}}, "W_DTS": {"summary": {"Unusualness": false, "Examples": ""}}, "W_ACTION": {"summary": {"Unusualness": false, "Examples": ""}}}, "recommend_testing": [{"name": "Chronological Watch History Check", "reasoning": "Watch actions for a customer should be recorded in chronological order", "sql": "SELECT * FROM (SELECT *, LAG(W_DTS) OVER (PARTITION BY W_C_ID ORDER BY W_DTS) as prev_dts FROM fact_watch_history) sub WHERE prev_dts IS NOT NULL AND W_DTS < prev_dts"}, {"name": "Unique Action Timestamp Check", "reasoning": "A customer cannot perform more than one action on the same symbol at the exact same timestamp", "sql": "SELECT W_C_ID, W_S_SYMB, W_DTS, COUNT(*) FROM fact_watch_history GROUP BY W_C_ID, W_S_SYMB, W_DTS HAVING COUNT(*) > 1"}, {"name": "Logical Sequence of Actions Check", "reasoning": "A 'CNCL' action should only occur after an 'ACTV' action for the same symbol per customer", "sql": "SELECT actv.W_C_ID, actv.W_S_SYMB FROM fact_watch_history actv LEFT JOIN fact_watch_history cncl ON actv.W_C_ID = cncl.W_C_ID AND actv.W_S_SYMB = cncl.W_S_SYMB AND cncl.W_ACTION = 'CNCL' WHERE actv.W_ACTION = 'ACTV' AND cncl.W_DTS < actv.W_DTS"}]}