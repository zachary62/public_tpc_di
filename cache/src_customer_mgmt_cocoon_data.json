{"project": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "duplicate_rows": {"duplicated_indices": [], "num_duplicated_rows": 0, "remove_duplicates": false}, "missing_columns": {"missing_column_indices": [], "missing_column_names": [], "remove_columns": []}, "duplicate_columns": {"duplicated_column_indices": [], "duplicated_column_names": [], "remove_columns": []}, "x_y_columns": {"x_y_column_indices": [], "x_y_column_names": [], "remove_columns": []}, "index_columns": {"index_column_indices": [], "index_column_names": [], "remove_columns": []}, "data_type": {"ActionType": {"data_type": "VARCHAR"}, "ActionTS": {"data_type": "VARCHAR"}, "C_ID": {"data_type": "BIGINT"}, "C_TAX_ID": {"data_type": "VARCHAR"}, "C_GNDR": {"data_type": "VARCHAR"}, "C_TIER": {"data_type": "DOUBLE"}, "C_DOB": {"data_type": "VARCHAR"}, "C_L_NAME": {"data_type": "VARCHAR"}, "C_F_NAME": {"data_type": "VARCHAR"}, "C_M_NAME": {"data_type": "VARCHAR"}, "C_ADLINE1": {"data_type": "VARCHAR"}, "C_ADLINE2": {"data_type": "VARCHAR"}, "C_ZIPCODE": {"data_type": "VARCHAR"}, "C_CITY": {"data_type": "VARCHAR"}, "C_STATE_PROV": {"data_type": "VARCHAR"}, "C_CTRY": {"data_type": "VARCHAR"}, "C_EMAIL_1": {"data_type": "VARCHAR"}, "C_EMAIL_2": {"data_type": "VARCHAR"}, "C_CTRY_1": {"data_type": "DOUBLE"}, "C_AREA_1": {"data_type": "DOUBLE"}, "C_LOCAL_1": {"data_type": "VARCHAR"}, "C_EXT_1": {"data_type": "DOUBLE"}, "C_CTRY_2": {"data_type": "DOUBLE"}, "C_AREA_2": {"data_type": "DOUBLE"}, "C_LOCAL_2": {"data_type": "VARCHAR"}, "C_EXT_2": {"data_type": "DOUBLE"}, "C_CTRY_3": {"data_type": "DOUBLE"}, "C_AREA_3": {"data_type": "DOUBLE"}, "C_LOCAL_3": {"data_type": "VARCHAR"}, "C_EXT_3": {"data_type": "DOUBLE"}, "C_LCL_TX_ID": {"data_type": "VARCHAR"}, "C_NAT_TX_ID": {"data_type": "VARCHAR"}, "CA_ID": {"data_type": "DOUBLE"}, "CA_TAX_ST": {"data_type": "DOUBLE"}, "CA_B_ID": {"data_type": "DOUBLE"}, "CA_NAME": {"data_type": "VARCHAR"}}, "main_entity": {"summary": "Customer Account Action", "reasoning": "The table is about the management of customer-related actions within a system or organization. The columns contain information about various actions taken on customer accounts, such as creating new accounts, updating accounts, closing accounts, and updating customer information. The data includes personal details of customers (like name, gender, date of birth, contact information), account details (like account IDs, tax status, branch ID), and action details (like action type and timestamp). The primary focus of the table is on the customers and the actions related to their accounts, suggesting that the main entity is the customer and the customer's interactions with the financial system."}, "column_meaning": {"summary": [{"column": "ActionType", "meaning": "type of action on account"}, {"column": "ActionTS", "meaning": "timestamp of action"}, {"column": "C_ID", "meaning": "customer identifier"}, {"column": "C_TAX_ID", "meaning": "customer tax identification number"}, {"column": "C_GNDR", "meaning": "customer gender"}, {"column": "C_TIER", "meaning": "customer tier level"}, {"column": "C_DOB", "meaning": "customer date of birth"}, {"column": "C_L_NAME", "meaning": "customer last name"}, {"column": "C_F_NAME", "meaning": "customer first name"}, {"column": "C_M_NAME", "meaning": "customer middle name initial"}, {"column": "C_ADLINE1", "meaning": "customer address line 1"}, {"column": "C_ADLINE2", "meaning": "customer address line 2"}, {"column": "C_ZIPCODE", "meaning": "customer zip or postal code"}, {"column": "C_CITY", "meaning": "customer city"}, {"column": "C_STATE_PROV", "meaning": "customer state or province"}, {"column": "C_CTRY", "meaning": "customer country"}, {"column": "C_EMAIL_1", "meaning": "customer primary email"}, {"column": "C_EMAIL_2", "meaning": "customer secondary email"}, {"column": "C_CTRY_1", "meaning": "country code for primary phone"}, {"column": "C_AREA_1", "meaning": "area code for primary phone"}, {"column": "C_LOCAL_1", "meaning": "local number for primary phone"}, {"column": "C_EXT_1", "meaning": "extension for primary phone"}, {"column": "C_CTRY_2", "meaning": "country code for secondary phone"}, {"column": "C_AREA_2", "meaning": "area code for secondary phone"}, {"column": "C_LOCAL_2", "meaning": "local number for secondary phone"}, {"column": "C_EXT_2", "meaning": "extension for secondary phone"}, {"column": "C_CTRY_3", "meaning": "country code for tertiary phone"}, {"column": "C_AREA_3", "meaning": "area code for tertiary phone"}, {"column": "C_LOCAL_3", "meaning": "local number for tertiary phone"}, {"column": "C_EXT_3", "meaning": "extension for tertiary phone"}, {"column": "C_LCL_TX_ID", "meaning": "local tax identifier"}, {"column": "C_NAT_TX_ID", "meaning": "national tax identifier"}, {"column": "CA_ID", "meaning": "account identifier"}, {"column": "CA_TAX_ST", "meaning": "account tax status"}, {"column": "CA_B_ID", "meaning": "bank identifier for account"}, {"column": "CA_NAME", "meaning": "account name or description"}]}, "rename_column": {"summary": [{"column": "ActionType", "ambiguous": false, "rename": ""}, {"column": "ActionTS", "ambiguous": false, "rename": ""}, {"column": "C_ID", "ambiguous": false, "rename": ""}, {"column": "C_TAX_ID", "ambiguous": false, "rename": ""}, {"column": "C_GNDR", "ambiguous": true, "rename": "C_GENDER"}, {"column": "C_TIER", "ambiguous": false, "rename": ""}, {"column": "C_DOB", "ambiguous": false, "rename": ""}, {"column": "C_L_NAME", "ambiguous": false, "rename": ""}, {"column": "C_F_NAME", "ambiguous": false, "rename": ""}, {"column": "C_M_NAME", "ambiguous": true, "rename": "C_MIDDLE_INITIAL"}, {"column": "C_ADLINE1", "ambiguous": false, "rename": ""}, {"column": "C_ADLINE2", "ambiguous": false, "rename": ""}, {"column": "C_ZIPCODE", "ambiguous": false, "rename": ""}, {"column": "C_CITY", "ambiguous": false, "rename": ""}, {"column": "C_STATE_PROV", "ambiguous": false, "rename": ""}, {"column": "C_CTRY", "ambiguous": true, "rename": "C_COUNTRY"}, {"column": "C_EMAIL_1", "ambiguous": false, "rename": ""}, {"column": "C_EMAIL_2", "ambiguous": false, "rename": ""}, {"column": "C_CTRY_1", "ambiguous": true, "rename": "C_COUNTRY_CODE_1"}, {"column": "C_AREA_1", "ambiguous": false, "rename": ""}, {"column": "C_LOCAL_1", "ambiguous": false, "rename": ""}, {"column": "C_EXT_1", "ambiguous": false, "rename": ""}, {"column": "C_CTRY_2", "ambiguous": true, "rename": "C_COUNTRY_CODE_2"}, {"column": "C_AREA_2", "ambiguous": false, "rename": ""}, {"column": "C_LOCAL_2", "ambiguous": false, "rename": ""}, {"column": "C_EXT_2", "ambiguous": false, "rename": ""}, {"column": "C_CTRY_3", "ambiguous": true, "rename": "C_COUNTRY_CODE_3"}, {"column": "C_AREA_3", "ambiguous": false, "rename": ""}, {"column": "C_LOCAL_3", "ambiguous": false, "rename": ""}, {"column": "C_EXT_3", "ambiguous": false, "rename": ""}, {"column": "C_LCL_TX_ID", "ambiguous": true, "rename": "C_LOCAL_TAX_ID"}, {"column": "C_NAT_TX_ID", "ambiguous": true, "rename": "C_NATIONAL_TAX_ID"}, {"column": "CA_ID", "ambiguous": false, "rename": ""}, {"column": "CA_TAX_ST", "ambiguous": true, "rename": "CA_TAX_STATUS"}, {"column": "CA_B_ID", "ambiguous": false, "rename": ""}, {"column": "CA_NAME", "ambiguous": false, "rename": ""}]}, "table_summary": {"summary": "The table 'src_customer_mgmt' captures details related to Customer Account Action events. Each row represents an action taken on a customer's account, with the **ActionType** indicating the nature of the action, such as the creation of a new account. The **ActionTS** attribute timestamps the action, providing a precise record of when it occurred.\n\nCustomer identification is detailed through attributes like **C_ID** for the customer's unique identifier, **C_TAX_ID** for tax identification, and **C_GNDR** for gender. The **C_TIER** attribute may represent the customer's tier or level within the company's categorization system. Personal details are captured in attributes such as **C_DOB** for date of birth, **C_L_NAME** for the last name, **C_F_NAME** for the first name, and **C_M_NAME** for the middle name.\n\nContact information is extensive, with attributes like **C_ADLINE1** and **C_ADLINE2** for address lines, **C_ZIPCODE** for the postal code, **C_CITY** for the city, **C_STATE_PROV** for the state or province, and **C_CTRY** for the country. Email addresses are stored in **C_EMAIL_1** and **C_EMAIL_2**.\n\nPhone numbers are broken down by country, area, and local numbers, with **C_CTRY_1**, **C_AREA_1**, **C_LOCAL_1**, and **C_EXT_1** for the first phone number, followed by similar attributes for second and third numbers (**C_CTRY_2**, **C_AREA_2**, **C_LOCAL_2**, **C_EXT_2**, **C_CTRY_3**, **C_AREA_3**, **C_LOCAL_3**, **C_EXT_3**).\n\nTax-related attributes include **C_LCL_TX_ID** for local tax identification and **C_NAT_TX_ID** for national tax identification. The account-specific details are captured in **CA_ID** for the account identifier, **CA_TAX_ST** for the tax status, **CA_B_ID** for a related business identifier, and **CA_NAME** for the name associated with the account.\n\nOverall, the table provides a comprehensive dataset for managing customer account actions, including personal, contact, and account-specific information."}, "column_grouping": {"summary": {"Customer Account Action": {"Action Information": {"Action Details": ["ActionType", "ActionTS"]}, "Customer Information": {"Personal Information": ["C_ID", "C_TAX_ID", "C_GNDR", "C_TIER", "C_DOB", "C_L_NAME", "C_F_NAME", "C_M_NAME"], "Contact Information": {"Address": ["C_ADLINE1", "C_ADLINE2", "C_ZIPCODE", "C_CITY", "C_STATE_PROV", "C_CTRY"], "Emails": ["C_EMAIL_1", "C_EMAIL_2"], "Phones": {"Primary Phone": ["C_CTRY_1", "C_AREA_1", "C_LOCAL_1", "C_EXT_1"], "Secondary Phone": ["C_CTRY_2", "C_AREA_2", "C_LOCAL_2", "C_EXT_2"], "Tertiary Phone": ["C_CTRY_3", "C_AREA_3", "C_LOCAL_3", "C_EXT_3"]}}, "Tax Information": ["C_LCL_TX_ID", "C_NAT_TX_ID"]}, "Account Information": {"Account Details": ["CA_ID", "CA_NAME"], "Banking Information": ["CA_TAX_ST", "CA_B_ID"]}}}}, "visualization": {"summary": [{"name": "Histogram", "params": "C_TIER"}, {"name": "Histogram", "params": "C_GNDR"}, {"name": "Histogram", "params": "ActionType"}, {"name": "Histogram", "params": "C_STATE_PROV"}, {"name": "Histogram", "params": "C_CTRY"}]}, "missing_value": {"ActionType": {}, "ActionTS": {}, "C_ID": {}, "C_TAX_ID": {"summary": "Not Collected: Data deemed unnecessary initially"}, "C_GNDR": {"summary": "Non-Response: Individual chose not to disclose"}, "C_TIER": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_DOB": {"summary": "Not Collected: Data deemed unnecessary initially"}, "C_L_NAME": {"summary": "Not Collected: Data not gathered initially"}, "C_F_NAME": {"summary": "Not Collected: Data not gathered initially"}, "C_M_NAME": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_ADLINE1": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_ADLINE2": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_ZIPCODE": {"summary": "Not Collected: Data was overlooked or unnecessary"}, "C_CITY": {"summary": "Not Collected: Data not gathered initially"}, "C_STATE_PROV": {"summary": "Not Collected: Data deemed unnecessary or overlooked"}, "C_CTRY": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_EMAIL_1": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_EMAIL_2": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_CTRY_1": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_AREA_1": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_LOCAL_1": {"summary": "Not Collected: Data deemed unnecessary initially"}, "C_EXT_1": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_CTRY_2": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_AREA_2": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_LOCAL_2": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_EXT_2": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_CTRY_3": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_AREA_3": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_LOCAL_3": {"summary": "Not Collected: Oversight or deemed unnecessary"}, "C_EXT_3": {"summary": "Not Collected: Data was never gathered"}, "C_LCL_TX_ID": {"summary": "Not Collected: Data deemed unnecessary initially"}, "C_NAT_TX_ID": {"summary": "Not Collected: Data deemed unnecessary initially"}, "CA_ID": {"summary": "Not Collected: Information deemed unnecessary initially"}, "CA_TAX_ST": {"summary": "Not Collected: Data deemed unnecessary initially"}, "CA_B_ID": {"summary": "Not Collected: Data not gathered initially"}, "CA_NAME": {"summary": "Not Collected: Information deemed unnecessary initially"}}, "unusual": {"ActionType": {"summary": {"Unusualness": false, "Examples": ""}}, "ActionTS": {"summary": {"Unusualness": false, "Examples": ""}}, "C_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "C_TAX_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "C_GNDR": {"summary": {"Unusualness": true, "Examples": "Values such as 'B', 'd', 'P', 'j', 'x', etc., are unusual because they do not correspond to recognizable gender identifiers and suggest data quality issues.", "Explanation": "Unclear"}}, "C_TIER": {"summary": {"Unusualness": false, "Examples": ""}}, "C_DOB": {"summary": {"Unusualness": false, "Examples": ""}}, "C_L_NAME": {"summary": {"Unusualness": true, "Examples": "Values like 'PKDCD', 'KleynenbergNTACFB', and 'Td' are unusual because they do not follow typical surname conventions. 'LLoyd' may be a typographical error.", "Explanation": "Unclear"}}, "C_F_NAME": {"summary": {"Unusualness": false, "Examples": ""}}, "C_M_NAME": {"summary": {"Unusualness": false, "Examples": ""}}, "C_ADLINE1": {"summary": {"Unusualness": false, "Examples": ""}}, "C_ADLINE2": {"summary": {"Unusualness": false, "Examples": ""}}, "C_ZIPCODE": {"summary": {"Unusualness": false, "Examples": ""}}, "C_CITY": {"summary": {"Unusualness": false, "Examples": ""}}, "C_STATE_PROV": {"summary": {"Unusualness": false, "Examples": ""}}, "C_CTRY": {"summary": {"Unusualness": false, "Examples": ""}}, "C_EMAIL_1": {"summary": {"Unusualness": false, "Examples": ""}}, "C_EMAIL_2": {"summary": {"Unusualness": false, "Examples": ""}}, "C_CTRY_1": {"summary": {"Unusualness": true, "Examples": "Having only '1.0' as a value is unusual because country codes should vary and typically are not represented with a decimal point.", "Explanation": "Unclear"}}, "C_AREA_1": {"summary": {"Unusualness": false, "Examples": ""}}, "C_LOCAL_1": {"summary": {"Unusualness": false, "Examples": ""}}, "C_EXT_1": {"summary": {"Unusualness": true, "Examples": "Values like '61998.0', '70552.0' are unusual because phone extensions typically do not have decimals and are stored as integers.", "Explanation": "Unclear"}}, "C_CTRY_2": {"summary": {"Unusualness": true, "Examples": "1.0 values are unusual because country codes typically do not have decimals and should be diverse", "Explanation": "Unclear"}}, "C_AREA_2": {"summary": {"Unusualness": true, "Examples": "Values like '777.0', '708.0' are unusual because area codes are typically integer values without decimal points.", "Explanation": "Unclear"}}, "C_LOCAL_2": {"summary": {"Unusualness": false, "Examples": ""}}, "C_EXT_2": {"summary": {"Unusualness": true, "Examples": "Values like '3154.0', '29695.0' are unusual for phone extensions as they are typically not numeric or floating-point values.", "Explanation": "Unclear"}}, "C_CTRY_3": {"summary": {"Unusualness": true, "Examples": "The value '1.0' is unusual because country codes are typically alphabetic, not numeric.", "Explanation": "Unclear"}}, "C_AREA_3": {"summary": {"Unusualness": false, "Examples": ""}}, "C_LOCAL_3": {"summary": {"Unusualness": false, "Examples": ""}}, "C_EXT_3": {"summary": {"Unusualness": false, "Examples": ""}}, "C_LCL_TX_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "C_NAT_TX_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "CA_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "CA_TAX_ST": {"summary": {"Unusualness": false, "Examples": ""}}, "CA_B_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "CA_NAME": {"summary": {"Unusualness": true, "Examples": "The values are unusual because they consist of random characters, spaces, and special characters, which are not typical for account names or descriptions.", "Explanation": "Unclear"}}}, "recommend_testing": [{"name": "ActionTS Format Check", "reasoning": "The ActionTS should follow the datetime format 'YYYY-MM-DDTHH:MM:SS'", "sql": "select * from src_customer_mgmt where ActionTS not like '____-__-__T__:__:__'"}, {"name": "C_ID Uniqueness Check", "reasoning": "C_ID should be unique for each customer", "sql": "select C_ID, count(*) as cnt from src_customer_mgmt group by C_ID having cnt > 1"}, {"name": "C_TAX_ID Uniqueness Check", "reasoning": "C_TAX_ID should be unique for each customer", "sql": "select C_TAX_ID, count(*) as cnt from src_customer_mgmt group by C_TAX_ID having cnt > 1"}, {"name": "C_DOB Format Check", "reasoning": "C_DOB should follow the date format 'YYYY-MM-DD'", "sql": "select * from src_customer_mgmt where C_DOB not like '____-__-__'"}, {"name": "C_EMAIL_1 Format Check", "reasoning": "C_EMAIL_1 should be a valid email format", "sql": "select * from src_customer_mgmt where C_EMAIL_1 not like '%@%.%'"}, {"name": "C_EMAIL_2 Format Check", "reasoning": "C_EMAIL_2 should be a valid email format", "sql": "select * from src_customer_mgmt where C_EMAIL_2 not like '%@%.%'"}, {"name": "Phone Number Format Check", "reasoning": "Phone numbers should follow the format 'C_AREA-C_LOCAL'", "sql": "select * from src_customer_mgmt where not (C_LOCAL_1 like '___-____' and C_LOCAL_2 like '___-____' and C_LOCAL_3 like '___-____')"}, {"name": "Country Code Consistency Check", "reasoning": "Country codes should be consistent with the country", "sql": "select * from src_customer_mgmt where (C_CTRY = 'United States of America' and C_CTRY_1 != 1) or (C_CTRY = 'Canada' and C_CTRY_1 != 1)"}, {"name": "Customer Name Non-Empty Check", "reasoning": "Customer names should not be empty", "sql": "select * from src_customer_mgmt where trim(C_L_NAME) = '' or trim(C_F_NAME) = ''"}, {"name": "Customer Address Non-Empty Check", "reasoning": "Customer address line 1 should not be empty", "sql": "select * from src_customer_mgmt where trim(C_ADLINE1) = ''"}, {"name": "Customer Account Relationship Check", "reasoning": "Each account CA_ID should be associated with a valid customer C_ID", "sql": "select * from src_customer_mgmt where CA_ID is not null and C_ID is null"}, {"name": "Customer Tax Status Check", "reasoning": "CA_TAX_ST should be 0 for tax-exempt and 1 for taxable accounts", "sql": "select * from src_customer_mgmt where CA_TAX_ST not in (0, 1)"}]}