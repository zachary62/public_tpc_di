{"project": [0, 1, 2], "duplicate_rows": {"duplicated_indices": [], "num_duplicated_rows": 0, "remove_duplicates": false}, "missing_columns": {"missing_column_indices": [], "missing_column_names": [], "remove_columns": []}, "duplicate_columns": {"duplicated_column_indices": [], "duplicated_column_names": [], "remove_columns": []}, "x_y_columns": {"x_y_column_indices": [], "x_y_column_names": [], "remove_columns": []}, "index_columns": {"index_column_indices": [], "index_column_names": [], "remove_columns": []}, "data_type": {"TH_T_ID": {"data_type": "BIGINT"}, "TH_DTS": {"data_type": "TIMESTAMP"}, "TH_ST_ID": {"data_type": "VARCHAR"}}, "main_entity": {"summary": "Trade", "reasoning": "The table is about the historical records of trades in a financial or trading system. The 'TH_T_ID' column represents a numerical identifier for trades, suggesting that each row corresponds to a specific trade event. The 'TH_DTS' column contains timestamps for when these trade events occurred, indicating the date and time of each trade. The 'TH_ST_ID' column represents the status of the trade, such as submitted, completed, pending, or canceled. The main underlying entity is the trade itself, as the table records various attributes and states of individual trades over time."}, "column_meaning": {"summary": [{"column": "TH_T_ID", "meaning": "Trade ID, unique identifier for each trade"}, {"column": "TH_DTS", "meaning": "Date and time stamp of the trade event"}, {"column": "TH_ST_ID", "meaning": "Trade status ID, indicating the current status of the trade"}]}, "rename_column": {"summary": [{"column": "TH_T_ID", "ambiguous": false, "rename": ""}, {"column": "TH_DTS", "ambiguous": false, "rename": ""}, {"column": "TH_ST_ID", "ambiguous": false, "rename": ""}]}, "table_summary": {"summary": "The table 'fact_trade_history' captures the historical events of trade transactions. It consists of 982,180 rows, each representing a specific event in the lifecycle of a trade. There are 3 columns in the table that detail the attributes of these events:\n\n- **TH_T_ID**: This attribute serves as an identifier for the trade transaction. It appears that the same trade transaction can have multiple events, as the first two rows share the same **TH_T_ID** value of 0.\n  \n- **TH_DTS**: This attribute records the date and time when the event occurred, providing a timestamp for each event in the trade's history. For example, the first event occurred on \"2012-07-07 00:01:13\" and the second event on \"2012-07-07 00:02:34\".\n\n- **TH_ST_ID**: This attribute indicates the status of the trade at the time of the event, such as \"SBMT\" (submitted) and \"CMPT\" (completed), which helps in tracking the progression of the trade from initiation to completion.\n\nTogether, these attributes provide a comprehensive view of the trade's progression over time, capturing the chronological sequence of events and their corresponding statuses."}, "column_grouping": {"summary": {"Trade": {"Trade_ID": ["TH_T_ID"], "Trade_Details": {"Timestamp": ["TH_DTS"], "Status": ["TH_ST_ID"]}}}}, "visualization": {"summary": [{"name": "Histogram", "params": "TH_ST_ID"}]}, "missing_value": {"TH_T_ID": {}, "TH_DTS": {}, "TH_ST_ID": {}}, "unusual": {"TH_T_ID": {"summary": {"Unusualness": false, "Examples": ""}}, "TH_DTS": {"summary": {"Unusualness": false, "Examples": ""}}, "TH_ST_ID": {"summary": {"Unusualness": false, "Examples": ""}}}, "recommend_testing": [{"name": "Trade Status Progression", "reasoning": "A trade should progress from 'SBMT' to 'PNDG' to 'CMPT' or 'CNCL'. A trade should not have a 'CMPT' or 'CNCL' status before 'SBMT'.", "sql": "WITH OrderedStatus AS (SELECT TH_T_ID, TH_DTS, TH_ST_ID, ROW_NUMBER() OVER (PARTITION BY TH_T_ID ORDER BY TH_DTS ASC) as rn FROM fact_trade_history) SELECT o1.TH_T_ID FROM OrderedStatus o1 JOIN OrderedStatus o2 ON o1.TH_T_ID = o2.TH_T_ID AND o1.rn = o2.rn - 1 WHERE (o1.TH_ST_ID = 'CMPT' AND o2.TH_ST_ID = 'SBMT') OR (o1.TH_ST_ID = 'CNCL' AND o2.TH_ST_ID = 'SBMT')"}, {"name": "Duplicate Trade Status Timestamps", "reasoning": "There should not be multiple entries with the same trade ID and timestamp but different statuses.", "sql": "SELECT TH_T_ID, TH_DTS FROM fact_trade_history GROUP BY TH_T_ID, TH_DTS HAVING COUNT(DISTINCT TH_ST_ID) > 1"}, {"name": "Trade Status Completeness", "reasoning": "Every trade that has a 'CMPT' status should have a 'SBMT' status entry before it.", "sql": "SELECT DISTINCT t1.TH_T_ID FROM fact_trade_history t1 LEFT JOIN fact_trade_history t2 ON t1.TH_T_ID = t2.TH_T_ID AND t2.TH_ST_ID = 'SBMT' WHERE t1.TH_ST_ID = 'CMPT' AND t2.TH_T_ID IS NULL"}, {"name": "Trade Status Cancellation", "reasoning": "If a trade has a 'CNCL' status, it should not have a 'CMPT' status.", "sql": "SELECT DISTINCT t1.TH_T_ID FROM fact_trade_history t1 INNER JOIN fact_trade_history t2 ON t1.TH_T_ID = t2.TH_T_ID WHERE t1.TH_ST_ID = 'CNCL' AND t2.TH_ST_ID = 'CMPT'"}]}